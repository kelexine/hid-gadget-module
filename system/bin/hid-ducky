#!/system/bin/sh
# Magisk/KernelSU hid-ducky wrapper with auto-recovery
if ! /system/bin/hid-gadget ducky "$@"; then
    echo "DuckyScript execution failed, attempting auto-fix..."
    su -c "setprop sys.usb.config hid && /system/bin/hid-setup"
    exec /system/bin/hid-gadget ducky "$@"
fi
