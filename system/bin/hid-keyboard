#!/system/bin/sh
# Magisk/KernelSU hid-keyboard wrapper with auto-recovery
if ! /system/bin/hid-gadget keyboard "$@"; then
    echo "HID Keyboard failed, attempting auto-fix..."
    su -c "setprop sys.usb.config hid && /system/bin/hid-setup"
    exec /system/bin/hid-gadget keyboard "$@"
fi
