#!/system/bin/sh
# Magisk/KernelSU hid-mouse wrapper with auto-recovery
if ! /system/bin/hid-gadget mouse "$@"; then
    echo "HID Mouse failed, attempting auto-fix..."
    su -c "setprop sys.usb.config hid && /system/bin/hid-setup"
    exec /system/bin/hid-gadget mouse "$@"
fi
