#!/system/bin/sh
# Magisk/KernelSU hid-consumer wrapper with auto-recovery
if ! /system/bin/hid-gadget consumer "$@"; then
    echo "HID Consumer failed, attempting auto-fix..."
    su -c "setprop sys.usb.config hid && /system/bin/hid-setup"
    exec /system/bin/hid-gadget consumer "$@"
fi
